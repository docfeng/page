
$=(function(){
     if(!document.querySelector("#msg_box")){
     var style = document.createElement("style");
     style.id="msg_box" 
     style.type = "text/css";
     style.innerHTML=`
.setting_m_box{
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  //background-color:OrangeRed;
  z-index:113;
  display:none;
}
.setting_box{
  position:fixed;
  width:100%;
  min-height:50%;
  bottom:0px;
  background-color:Orange;
}`;
        document.getElementsByTagName("HEAD").item(0).appendChild(style);
    }
     var obj=[];
     var createWin=function(){
         var obj={};
         var win=document.createElement("div");
         var box=document.createElement("div");
         var header=document.createElement("div");
         var section=document.createElement("div")
         var footer=document.createElement("div");
         var certain=document.createElement("input");
         var cancel=document.createElement("input");

         win.classList.add("setting_m_box");
         box.classList.add("setting_box");
         header.classList.add("setting_head_box");
         section.classList.add("setting_body_box");
         footer.classList.add("setting_footer_box");

         certain.type="button";
         cancel.type="button";
         certain.value="确定";
         cancel.value="取消";

         box.addEventListener("click",function(e){
              var event=e||window.event;
              event.stopPropagation();
         },false);

         certain.onclick=function(a){
                 obj.certain()
         }
    
         cancel.onclick=function(a){
             obj.cancel();
         }
  
         win.onclick=function(a){
             obj.cancel();
         };
         footer.append(cancel,certain);
         box.append(header,section,footer);
         win.appendChild(box);
         obj.win=win;
         obj.section=section;
         return obj;
     }


     var $={}
     $.select=async function(name,data,index){
          var obj=createWin()
          var section=obj.section;
          var win=obj.win;
          var re=index?data[index]:data[0];
          var d=document.createElement("div");
          d.innerHTML=name;
          d.onclick=function(e){
                 var ele=e.srcElement;
                 if(ele==d)return;
                 re=ele.innerHTML;
                 if(ele.style.backgroundColor=="blue"){
                      ele.style.backgroundColor="white";
                 }else{
                      ele.style.backgroundColor="blue";
                 }
         }
         for(var i=0;i<data.length;i++){
             var a=data[i];
             var s=document.createElement("div")
             s.innerHTML=a;
             d.appendChild(s);
         }
         section.appendChild(d);
         win.style.display="block";
         //alert(name)
         document.body.appendChild(win);

         return new Promise(function(resolve){
             obj.certain=function(a){
                     document.body.removeChild(win);
                     resolve(re);
             }
    
             obj.cancel=function(a){
                document.body.removeChild(win);
                 resolve(false);
             }
         });
     }
     $.msg=async function(arr){
         var re={};
         var obj=createWin()
         var section=obj.section;
         var win=obj.win;
         for(var i=0;i<arr.length;i++){
             let a=arr[i];
             let name=a[0];
             let value=a[1];
             let dataList=a[2];
             var d=document.createElement("div")
             d.innerHTML=name;
             re[name]=value||"";
             let text=document.createElement("input");
             text.type="text";
             text.value=value||"";
             text.oninput=function(e){
                     re[name]=text.value;
             }
             d.appendChild(text);
             if(dataList){
                     let s=document.createElement("input");
                     s.type="button";
                     s.value="选择";
                     s.onclick=async function(e){
                         var r=await $.select(name,dataList,0);
                         //alert(r)
                         text.value=r;
                         re[name]=r;
                     }
                    d.appendChild(s);
             }
             section.appendChild(d);
         }
         win.style.display="block";
         document.body.appendChild(win);
         return new Promise(function(resolve){
             obj.certain=function(a){
                 document.body.removeChild(win);
                 resolve(re);
             }
    
             obj.cancel=function(a){
                  document.body.removeChild(win);
                 resolve(false);
             }
         });
     }
     return $;
})()





$.select("储存",["input","方法","ffggg"],0).then(function(a){
    alert(a);
})

$.select("储存1",["input","方法","ffggg"],0).then(function(a){
    alert(a);
})







$.msg([
["储存","input","方法"],
["秦吏"],
["df","select",[1,2,3,4,6]]
]).then(function(a){
    alert(JSON.stringify(a,null,4));
})










